<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Example 10</title>
    <script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="../simple.mvc.js"></script>
    <script>
    $(function() {
      $('#viewId').ModelView(
        // Model
        {
          itemToAdd: 'sdf',
          items: MVC.List(['1', '2'])
        },
        // Settings & Methods (implementation)
        {
          isMirror: true,
          //preventDefault: true,
          controller: MVC.Controller({
            /*addEmailToModel: function(e, o) {
              o.Set('email', $("[name='email']").removeClass("excludeFromModel").val());
            },
            removeEmailFromModel: function(e, o) {
              $("[name='email']").addClass("excludeFromModel");
              o.RemoveProperty('email');
            },
            showModelData: function(e, o) { // event, object
              alert(JSON.stringify(o.GetModelData(), null, 4));
            },
            showObjectData: function(e, o) { // event, object
              alert(JSON.stringify(o, null, 4));
            }*/
          }),
          /*keyup: function(event, name, value, object) {
            if (MVC.KeyCheck(event, 'enter')) {
              event.preventDefault();
              alert(value);
              return false;
            }
          },*/
          change: function(event, name, value, object) {
            if(name === 'items') {
              object.Set('itemToAdd', value);
            }
            // console.log(name + " - " + value);
          },
          submit: function(event, name, value, object) {
            event.preventDefault();
            return false;
          },
          click: function(event, name, value, object) {
            event.preventDefault();
            if (name === 'addItem') {
              object.addItem();
            }
            else if (name === 'removeItem') {
              object.removeItem();
            }
            return false;
          }
        },
        // Methods
        {
          addItem: function() { // event, object
            var item = this.Get('itemToAdd');
            // this.Add('items', item);
            // this.Set('items', item);
            // // this.Add('item', item);
            var list = this.Get('items');
            list.Add(item);
            this.Set('items', list);
            this.FillSelect('items');
            console.log(this.Get('items'))
          },
          removeItem: function() {
            var item = this.Get('itemToAdd');
            var list = this.Get('items');
            list.Remove(item);
            this.FillSelect('items');
          },
          init: function(o) { // Simple MVC built-in initalize method which runs after 1 ms
            // console.log(o);
            // o.Set('items', MVC.List([]));
            // o.Set('itemToAdd', 'foobar');
            // alert(o.Get('itemToAdd'));
          }
        });


    });

    </script>
    <style>
      table, th, td {
         border: 1px solid #000;
      }
    </style>
  </head>
  <body>
   <form id="viewId" onsubmit="addItem() return false;">
    New item:
    <input name="itemToAdd" />
    <button type="submit" name="addItem">Add</button>
    <button type="submit" name="removeItem">Remove</button>
    <p>Your items:</p>
    <select multiple="multiple" width="50" style="width:100px;" name="items"> </select>
  </form>
  <span datasrc="#viewId" name="itemToAdd">...</span>
  <br />
  <span datasrc="#viewId" name="items">...</span>
  <br />
  <select datasrc="#viewId" multiple="multiple" width="50" style="width:100px;" name="items"></select>

  </body>
</html>