<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Example 7</title>
    <!--IE fixes -->
    <script type="text/javascript" src="../lib/json2.js"></script>
    <script type="text/javascript"> if (!window['console']) console = {log: function() {}}; </script>
    <!--//end IE fixes -->
    <!--<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>-->
    <script type="text/javascript" src="../lib/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="../simple.mvc.js"></script>
    <!--optional:-->
    <script type="text/javascript" src="../../simplemvc-showcase/lib/bootstrap/js/bootstrap.min.js"></script>
    <link type="text/css" rel="stylesheet" href="../../simplemvc-showcase/lib/bootstrap/css/bootstrap.css" />
    <!--//end optional-->
  </head>
  <body style="background-color:#fcfcfc; border:1px solid #ccc; padding: 5px;">
    <h1>Databound (+excludeFromModel)</h1>
    <h2>Inside the View</h2>
    <!-- View ID: testArea -->
    <div id="testArea">
      <h3>Elements in the View 'join' the Model</h3>
      <p>
        If a valid element is specified in the View, it will be added to the Model.
        <br />
        Valid elements: <code>input</code>, <code>p</code>, <code>span</code> and <code>div</code>.
        <br />
        The <code>name</code> and <code>datafld</code> attritubes will become the property name in the Model.
        <br />
      </p>
      Name: <input name="name" type="text" value="From View to Model" />
      <br />
      <br />
      <h3>The Model has precedence over the View</h3>
      <p>
        If a property is specified in the Model with the same name as an elements name, then the value specified in the View will get replaced by the value from the Model.
        <br />
        Look at the source code and you will see that the value in the DOM got replaced by the Model's.
      </p>
      Example: <input name="phone" type="text" value="I have lower priority" />
      <br />
      <br />
      <h3>Databound elements</h3>
      <p>
        Add the class <code>excludeFromModel</code> to an element (which resides inside the View), if you don't want it to 'join' the Model (as a property).
        <br />
        #1: This (span) element is excluded from the model and databound to the 'name' input element using the <code>datasrc</code> attribute: 
        <br />
        <span style="font-weight: bold;" class="excludeFromModel" datasrc="#testArea" name="name"> ... </span>
        <br />
        <br />
        #2: This (input) element is also excluded from model, but has not <code>datasrc</code> attribute specified and will therefore not receive any value when the databound element changes:
        <br />
        <input class="excludeFromModel" name="dontReceiveValueFromModel" type="text" />
      </p>
    </div><!-- //end of view -->
    <br />
    <h2>Outside the View</h2>
    <br />
    Databound element (to 'name') outside the View: <span style="font-weight: bold;" datasrc="#testArea" name="name" id="name"> </span>
    <script>
    var settings,
        obj;
    
    $(function() {
      settings = {
        keyup : function(e, n, v) {
          obj.SetModelFromView();
          printDebug();
        }
      };
      
      obj = MVC.ModelView('#testArea', {
        phone: 'I have higher priority',
        dontReceiveValueFromModel : '????'
      }, settings);
      
      $('#changeModelView').click(function() {
        var newValue = 'Type changed in Model and in View!';
        obj.Set('name', newValue);
        obj.SetModelFromView(true);
        printDebug();
      });
      
      $('#changeModelViewWontWork').click(function() {
        var newValue = 'Only changed in Model!';
        obj['name'] = newValue;
        printDebug();
      });
      
      $('#changeModelViewWillWorkCallingSetViewFromModel').click(function() {
        var newValue = 'Now the value is also in the View, but originally changed in the Model!';
        obj['name'] = newValue;
        obj.SetViewFromModel();
        printDebug();
      });
      
      function printDebug() {
        DebugObj('#debug', { o1 : { object : obj, readDom : true } });
      }
    });
    </script>
    <div id="debug"> </div>
    <script src="debug.js"></script>
  </body>
</html>