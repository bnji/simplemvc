var MVC={KeyCheck:function(t,e){return(13!==t.keyCode||"enter"!==e&&"return"!==e)&&(27!==t.keyCode||"escape"!==e&&"esc"!==e)?!1:!0},List:function(t){if(null===t||void 0===t)t=[];else if(!$.isArray(t)&&"object"==typeof t){var e=[],n=0;$.each(t,function(t,i){"function"!=typeof i&&(e[n]=i,n++)}),t=e}return t.Size=function(){return t.length},t.Add=function(e){return t.push(e),t},t.Get=function(e){return t[e]},t.Find=function(e,n){var i=null;return $.each(t,function(t,r){return r[e]===n?(i=r,!1):void 0}),i},t.Remove=function(e){var n=$.inArray(e,t);return-1!==n?(t.splice(n,1),!0):!1},t.RemoveAt=function(t){return this.Remove(this.Get(t))},t.Contains=function(e){return-1!==$.inArray(e,t)},t.Clear=function(){t=[]},t},Controller:function(t){return t}};!function(t){t.fn.extend({ModelView:function(e,n,i){var r=[];$this=t(this);var a="#"+$this.attr("id");e=e?t.extend({},!0,e):{},i?e=t.extend({},!0,e,i):i={},n||(n={});var o=n.datasrc,u=n.clone;if(void 0!==u){u.template=a,a=void 0===u.id?"#"+t.now():""+u.id,viewIdNoHash="#"===a.substring(0,1)?a.substring(1,a.length):a;var c=n.clone.withDataAndEvents;c=void 0!==c?c:!1,n.clone.withDataAndEvents=c;var d=t(t(u.template).clone(c)).attr("id",viewIdNoHash);o=void 0!==o?o:a,t(d).find('[datasrc=""]').attr("datasrc",o),u.append(d)}void 0===n.viewId&&t.extend(n,{viewId:a}),void 0===n.isMirror&&t.extend(n,{isMirror:!0}),void 0===n.eventUsed&&t.extend(n,{eventUsed:""}),void 0===n.preventDefault&&t.extend(n,{preventDefault:!0}),t(a).find("*").each(function(){t(this).hasClass("isEvent")&&t(this).click(function(i){var r=t(i.target).attr("name");e.Start(r,i),n.settings.preventDefault&&i.preventDefault()})}),e.Save=function(t){return e.Start("Save",t)},e.Update=function(t){return e.Start("Update",t)},e.Delete=function(t){return e.Start("Delete",t)},e.Clear=function(t){return e.Set(t,""),e[t]="",e},e.ClearAll=function(){return t.each(e.GetModelData(),function(t){e.Clear(t)}),e},e.AddGetSet=function(n){return t(e).bind("get"+n,function(t,i){i.value=e[n]}).bind("set"+n,function(t,i){var r=e[n];r!==i&&(e[n]=i,e.SetViewFromModel(),e.TriggerEvent(n,"change"))}),e},e.RemoveGetSet=function(n){return t(e).unbind("get"+n).unbind("set"+n),e},e.TriggerEvent=function(n,i){return t(a+' :input[name="'+n+'"]').not(".excludeFromModel").trigger(i),e},e.AddProperty=function(t,n){return e[t]=n,e.AddGetSet(t),e},e.RemoveProperty=function(t){return e.RemoveGetSet(t),delete e[t],e},e.Remove=function(t,n){var i=e.Get(n),r=e.Get(t);r.Remove(i),e.FillSelect(t)},e.Add=function(t,n){var i=e.Get(t);i.Add(n),e.FillSelect(t)},e.Set=function(n,i){return"function"==typeof i&&(r.push({name:n,func:i}),i=i(e)),e.settings.isMirror&&!e.Has(n)&&e.AddProperty(n,i),t(e).triggerHandler("set"+n,[i]),e._SetDataboundDomVal(o?o:a,n,i),e},e.Get=function(n){var i={value:void 0};return t(e).triggerHandler("get"+n,[i]),i.value},e.Has=function(t){return void 0!==e.Get(t)?!0:!1},e.GetDatasrcId=function(){return e.datasrc},e.GetModelData=function(n){var i={};return t.each(e,function(t,e){if("function"!==(typeof e).toString()){if(/jQuery\d*/.test(t))return!0;if(!n&&"settings"===t)return!0;i[t]=e}}),i},e.GetViewHtml=function(){return $this},e.GetViewData=function(){return t(a).getSetHtml()},e.SetViewData=function(){t(a).getSetHtml(e)},e.SetViewFromModel=function(){e.SetViewData();var n=e.GetModelData();return t.each(n,function(t,n){e._SetDataboundDomVal(a,t,n)}),e},e.SetModelFromView=function(){var n=e.GetViewData();return t.each(n,function(t,n){var i=e[t];i!==n&&void 0!==n&&null!==n&&(e[t]=n),e._SetDataboundDomVal(a,t,n)}),t.each(r,function(t,n){e.Set(n.name,n.func(e))}),e},e._SetDataboundDomVal=function(n,i,r){if(r){var a=navigator.appVersion;-1!==a.indexOf("MSIE 7.")||-1!==a.indexOf("MSIE 8.")?(t('div[datasrc="'+n+'"][name="'+i+'"],p[datasrc="'+n+'"][name="'+i+'"],span[datasrc="'+n+'"][name="'+i+'"]').text(r),t('div[datasrc="'+n+'"],p[datasrc="'+n+'"],span[datasrc="'+n+'"]').find('div[name="'+i+'"],p[name="'+i+'"],span[name="'+i+'"]').text(r),t('div[datasrc="'+n+'"],p[datasrc="'+n+'"],span[datasrc="'+n+'"]').find('input[name="'+i+'"]').val(r)):(t('*[datasrc="'+n+'"][name="'+i+'"]').text(r),t('*[datasrc="'+n+'"]').find('*[name="'+i+'"]').text(r),t('*[datasrc="'+n+'"]').find('*[name="'+i+'"]').val(r)),t('input[datasrc="'+n+'"][name="'+i+'"]').val(r);var o=t('select[datasrc="'+n+'"][name="'+i+'"]');e._FillSelect(o,i,r),o=t('*[datasrc="'+n+'"]').find('select[name="'+i+'"]'),e._FillSelect(o,i,r)}return e},e._FillSelect=function(n,i,r){var a=e.Get(i);"object"==typeof a&&n.size()>0&&(n.empty(),t.each(r,function(e,i){n.append(t("<option />").attr({value:i}).text(i))}))},e.FillSelect=function(n,i,r){var a=i?"()"===i.substring(i.length-2,i.length):!1,o=r?"()"===r.substring(r.length-2,r.length):!1,u=e.Get(n);return t.each(e.Find('select[name*="'+n+'"]'),function(e,n){n=t(n),n.empty(),t.each(u,function(e,u){var c=i?a?u[i.substring(0,i.length-2)]():u[i]:u,d=r?o?u[r.substring(0,r.length-2)]():u[r]:u;n.append(t("<option />").attr({value:d}).text(c))})}),e},e.RunEvent=function(i){var r=i.target.name,a=i.target.value,o=i.type;if(void 0===o&&(o=i),void 0!==i){if(t.trim(r).length>0&&void 0!==n.settings[o]&&null!==n.settings[o]){n.settings.eventUsed=o;var u=e[r],c=u;if(-1!==i.target.type.indexOf("select")){var d=i.target.selectedIndex,s=i.target.options[d];s&&(a=s.value,c=u[d])}n.settings[o](i,r,a,e,u,c)}return e}},e.Start=function(t,n){var i;return void 0!==e.settings.controller&&(i=e.settings.controller[t]),void 0===i&&(i=e[t]),void 0!==i&&null!==i?i(n,e):console.log("Missing "+t+"() method!"),e},e.toArray=function(){return t.makeArray(e)},e.GetViewId=function(){return e.settings.viewId},e.Find=function(n){return t(e.GetViewId()+" "+n)},e.AddEvents=function(){return t(a+" :input").focus(function(t){e.RunEvent(t)}).blur(function(t){e.RunEvent(t)}).change(function(t){e.SetModelFromView(),e.RunEvent(t)}).select(function(t){e.RunEvent(t)}).submit(function(t){e.RunEvent(t)}).click(function(t){e.SetModelFromView(),e.RunEvent(t)}).keyup(function(t){void 0===n.settings.keyup&&e.SetModelFromView(),e.RunEvent(t)}).keypress(function(t){e.RunEvent(t)}).keydown(function(t){e.RunEvent(t)}),e},e.SetViewFromModel(),e.SetModelFromView(),n.isMirror&&t.each(e.GetModelData(),function(t){e.AddGetSet(t)}),n.autoSaveInterval>0&&(n.eventUsed='"autoSave"',setInterval(function(){e.Save()},n.autoSaveInterval)),e.AddEvents(),n={settings:n},t.extend(e,n);var s=e.init;return void 0!==s&&null!==s&&s(e),e}})}(jQuery),function(t){t.fn.extend({getSetHtml:function(t){return void 0!==t?this.setValues(t):this.getValues()},getInputElements:function(t){return t.find("input,select,textarea").not(".excludeFromModel")},getElementKey:function(e){var n=t(e).attr("datafld");return void 0===n&&(n=t(e).attr("id")),void 0===n&&(n=t(e).attr("data-bind")),n},getBindableElements:function(t){return t.find("*[data-bind], *[datafld]").filter(":not(.excludeFromModel)")},setValues:function(e){var n=this;n.getBindableElements(this).each(function(){var i=n.getElementKey(this);if(void 0!==i){var r=e[i];t(this).html(r)}}),n.getInputElements(this).each(function(){var n,i=e[t(this).attr("name")];if(void 0!==i)if(n=t(this),n.is("select")){if(!n.val()){var r=n;r.empty(),t.each(i,function(e,n){var i=n,a=n;"object"==typeof n&&t.each(n,function(t,e){var r="function"==typeof e;i=r?n.toString():t,a=r?n.toString():e}),r.append(t("<option />").attr({value:a}).text(i))})}}else n.is(":radio")?n.val()===i&&n.attr("checked",!0):n.is(":checkbox")?(i?n.attr("checked",!0):(i=t.isArray(i)?i:[i],t.inArray(n.val(),i)>-1&&n.attr("checked",!0)),n.val(i)):n.val(i)})},getValues:function(){var e={},n={},i=this;return i.getInputElements(this).each(function(){var e=t(this),i=e.attr("type"),r=e.attr("name"),a=e.val();if("submit"!==i&&r)if(e.hasClass("isNumber")&&(a=parseInt(a,null)),e.is("select")){var o=MVC.List([]);t.each(e.find("option"),function(e,n){o.Add(t(n).val())}),a=o,n[r]=a}else e.is(":checkbox")?(a=!1,e.attr("checked")|e.prop("checked")&&(a=!0),n[r]=a):e.is(":radio")?e.attr("checked")|e.prop("checked")&&(n[r]=a):n[r]=a}),i.getBindableElements(this).each(function(){var n=t(this),r=n.text();if(void 0!==r){var a=i.getElementKey(this);if(void 0===a)return;n.hasClass("isNumber")&&(r=parseInt(r,null)),e[a]=r}}),t.extend(e,n),e}})}(jQuery),String.prototype.format=String.prototype.f=function(){for(var t=this,e=arguments.length;e--;)t=t.replace(new RegExp("\\{"+e+"\\}","gm"),arguments[e]);return t};