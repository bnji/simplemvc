<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>demo&#x2F;todo&#x2F;todo.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Controller.html">Controller</a></li>
            
                <li><a href="..&#x2F;classes/List.html">List</a></li>
            
                <li><a href="..&#x2F;classes/ModelView.html">ModelView</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/MVC.html">MVC</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: demo&#x2F;todo&#x2F;todo.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
var ctr,
    data,
    notebook,
    settings,
    viewId = &#x27;#todos&#x27;;
    
$(function() {
  
  
  
  &#x2F;&#x2F;Controller
  ctr = MVC.Controller({
    clearDone : function() {
      notebook.clearDone();
    },
    clearAll : function() {
      notebook.clearAll();
    },
    exportJSON : function() {
      $.ajax({
        type : &quot;POST&quot;,
        url : &quot;http:&#x2F;&#x2F;hammerbenjamin.com&#x2F;simplemvc-showcase&#x2F;savejson.php&quot;,
        dataType : &#x27;json&#x27;, 
        data : {
            json : JSON.stringify(notebook.getNotes())
        },
        success : function(result) {
          $linkToJsonFile = &#x27;&lt;a href=&quot;&#x27;+result[&#x27;url&#x27;]+&#x27;&quot;&gt;Open the JSON file.&lt;&#x2F;a&gt;&#x27;;
          $(&#x27;#jsonFileUrl&#x27;).html($linkToJsonFile);
        }
      });
    }
  });
  
  
  data = {
    notes: MVC.List(), &#x2F;&#x2F;Use our MVC Array with extra methods
    isValidInput : function(data) {
      return $.trim(data).length &gt; 0;
    },
    &#x2F;&#x2F;Add a new note
    createNote : function(value, isComplete, id) {
      &#x2F;&#x2F;Only if the note has some text
      if(notebook.isValidInput(value)) {
        &#x2F;&#x2F;The note data (it&#x27;s field members and methods)
        var noteData = {
          id: (id === undefined || id === null ? $.now() : id),
          isComplete: isComplete,
          note: value,
          toggleMode : function() {
            &#x2F;&#x2F;don&#x27;t toggle modes if the note is done
            if(!note.Get(&#x27;isComplete&#x27;)) {
              note
                .FindElement(&#x27;#note&#x27;)
                .toggle(500);
              note
                .FindElement(&#x27;:input[name=&quot;note&quot;]&#x27;)
                .toggle(500, function(){
                  $(this).focus();
                });
            }
          },
          init : function() {
            note
              .FindElement(&#x27;#note&#x27;)
              .click(function() {
                note.toggleMode();
              });
          }
        };
       
        &#x2F;&#x2F;The note controller for the GUI buttons
        var noteController = MVC.Controller({
          showData : function() {
            &#x2F;&#x2F;note.toggleMode();
            alert(JSON.stringify(note, null, 2));
          }
        });
        
        &#x2F;&#x2F;
        var noteSettings = {
          controller: noteController,
          change: function(e, n, v) {
            store
              .save(note); &#x2F;&#x2F;Store the data
            notebook
              .onCheckNote(note);
          },
          keyup: function(e, n, v) {
            if(notebook.isValidInput(v)) {
              if(MVC.KeyCheck(e, &#x27;enter&#x27;)) {
                store
                  .save(note); &#x2F;&#x2F;Store the data
                note
                  .toggleMode(); &#x2F;&#x2F;Toggle to view mode again
              }
              if(MVC.KeyCheck(e, &#x27;escape&#x27;)) {
                if(notebook.isValidInput(note)) {
                  note
                    .FindElement(&#x27;:input[name=&quot;note&quot;]&#x27;)
                    .blur();
                }
              }
            }
          },
          blur: function() {
            note
              .toggleMode();
          },
          clone: {
              id: &#x27;#liNoteElem&#x27;+$.now(),
              withDataAndEvents: false,
              append: function(elem) {
                $(&#x27;#note-list&#x27;).prepend(elem);
                $(elem).show();
              }
          }
        };
        
        &#x2F;&#x2F;Create a new note using the MVC ModelView
        var note = MVC.ModelView(&#x27;#list-template&#x27;, noteData, noteSettings);
        
        notebook.add(note);
      }
      return notebook;
    },
    add : function(note) {
      notebook
          .getNotes() &#x2F;&#x2F;Retrieve the list of notes
          .Add(note); &#x2F;&#x2F;Add the note to the notebook
          
      notebook
          .onAddRemove(note) &#x2F;&#x2F;Update databound elements
          .onCheckNote(note); &#x2F;&#x2F;Update databound elements
          
      store
        .save(note); &#x2F;&#x2F;Store the note
        
      return notebook;
    },
    remove : function(note) {
      var isRemoved = notebook
                        .getNotes() &#x2F;&#x2F;Get the list of notes (Array)
                        .Remove(note); &#x2F;&#x2F;Remove the note (from the Array)
      if(isRemoved) {
        notebook
          .onAddRemove(note) &#x2F;&#x2F;Update databound elements
          .onCheckNote(note) &#x2F;&#x2F;Update databound elements
          .focusInput();
          
        store
          .remove(note); &#x2F;&#x2F;Remove the note (from the storage)
      }
      return notebook;
    },
    getNotes : function() {
      return notebook.Get(&#x27;notes&#x27;);
    },
    getNotesDone : function() {
      var notesDone = MVC.List();
      $.each(notebook.getNotes(), function(i, note) {
        if(note.Get(&#x27;isComplete&#x27;)) {
          notesDone.Add(note);
        }
      });
      return notesDone;
    },
    getNotesCount : function() {
      return notebook.getNotes().length;
    },
    getNotesDoneCount : function() {
      return notebook.getNotesDone().length;
    },
    clearDone : function() {
      $.each(notebook.getNotes(), function(k, note) {
        if(note.Get(&#x27;isComplete&#x27;)) {
          $(note.GetViewId()).slideUp(&#x27;slow&#x27;, function() {
            notebook.remove(note); &#x2F;&#x2F;Remove the note the Model
            $(this).remove(); &#x2F;&#x2F;Remove the note from the View
            &#x2F;&#x2F;console.log(&quot;Notes count: &quot; + notebook.getNotes().length);
          });
        }
      });
      return notebook;
    },
    clearAll : function(isCompleteFilter) {
      $.each(notebook.getNotes(), function(k, note) {
        $(note.GetViewId()).slideUp(&#x27;slow&#x27;, function() {
          notebook.remove(note); &#x2F;&#x2F;Remove the note the Model
          $(this).remove(); &#x2F;&#x2F;Remove the note from the View
          &#x2F;&#x2F;console.log(&quot;Notes count: &quot; + notebook.getNotes().length);
        });
      });
      return notebook;
    },
    focusInput : function() {
      notebook
        .FindElement(&#x27;.create&#x27;)
        .val(&#x27;&#x27;)
        .focus();
    },
    loadNotes : function() {
      var notesFromStore = store.getAll();
      $.each(notesFromStore, function(k,v) {
        notebook.createNote(v[&#x27;note&#x27;], v[&#x27;isComplete&#x27;], k);
      });
    },
    clear : function() {
      store.clear();
      return notebook.clearAll();
    },
    onAddRemove : function(note) {
      $(&#x27;.notesCountText&#x27;).html(notebook.getNotesCount() === 1 ? &#x27;item&#x27; : &#x27;items&#x27;);
      $(&#x27;#notesCount&#x27;).html(notebook.getNotesDoneCount() + &#x27; &#x2F; &#x27; + notebook.getNotesCount());
      return notebook;
    },
    onCheckNote : function(note) {
      var noteElem = note.FindElement(&#x27;#note&#x27;);
      var notesDone = notebook.getNotesDoneCount();
      
      if(note.Get(&#x27;isComplete&#x27;)) {
        noteElem.addClass(&#x27;isComplete&#x27;);
      } else {
        noteElem.removeClass(&#x27;isComplete&#x27;);
      }
      
      if(notesDone &gt; 0) {
        $(&#x27;#clearDone&#x27;).fadeIn(500);
      }
      else {
        $(&#x27;#clearDone&#x27;).fadeOut(500);
      }
      
      $(&#x27;.notesDone&#x27;).html(notesDone === 1 ? &#x27;item&#x27; : &#x27;items&#x27;);
      $(&#x27;#notesDone&#x27;).html(notesDone);
      $(&#x27;#notesCount&#x27;).html(notesDone + &#x27; &#x2F; &#x27; + notebook.getNotesCount());
      printDebug();
      return notebook;
    },
    init : function() {
      notebook.focusInput();
      notebook.loadNotes();
    }
  }
  
  &#x2F;&#x2F;Settings
  settings = {
    controller: ctr,
    keyup : function(e, n, v) {
      printDebug();
      if(n === &#x27;create&#x27;) {
        if(MVC.KeyCheck(e, &#x27;enter&#x27;)) {
          $(e.target).val(&#x27;&#x27;); &#x2F;&#x2F;Clear the input
          notebook.createNote(v, false);
          &#x2F;&#x2F;notebook.RunCtr(&#x27;createNote&#x27;, {value:v, isComplete:false}) &#x2F;&#x2F;Add the note
        }
      }
      notebook.SetModelFromView();
      &#x2F;&#x2F;notebook.SetViewFromModel();
    }
    
  };
  
  &#x2F;&#x2F;Create a notebook (object literal) which manages the todo notes
  notebook = MVC.ModelView(viewId, data, settings);
  
  &#x2F;&#x2F;Clear the notebook and add 3 notes
  &#x2F;*notebook
    .clear()
    .createNote(&#x27;Buy some milk&#x27;, true)
    .createNote(&#x27;Drink the milk&#x27;, false)
    .createNote(&#x27;Open lifehacker.com&#x27;, false);
  *&#x2F;
  
  
  
  
  &#x2F;*$.each(notebook, function(k, v) {
    var t = typeof v;
    if(t.toString() !== &#x27;function&#x27; &amp;&amp; t.toString() !== &#x27;object&#x27;) {
      console.log(k + &quot; is a &quot; + t);
    }
  });*&#x2F;
  
  
});

&#x2F;**
 * An implementation using jStorage (localstorage) which saves&#x2F;loads the notes.
 * http:&#x2F;&#x2F;www.jstorage.info&#x2F;
 *&#x2F;
var store = {
  save : function(note) {
    var key = note.Get(&#x27;id&#x27;);
    var value = {
      note: note.Get(&#x27;note&#x27;), 
      isComplete: note.Get(&#x27;isComplete&#x27;)
    };
    $.jStorage.set(key, value);
  },
  remove : function(note) {
    $.jStorage.deleteKey(note.Get(&#x27;id&#x27;));
  },
  clear : function() {
    $.jStorage.flush();
  },
  get : function(key) {
    return $.jStorage.get(key);
  },
  getAll : function() {
    var data = {};
    $.each($.jStorage.index(), function(k, v) {
      data[v] = store.get(v);
      &#x2F;&#x2F;console.log(data[v]);
    });
    return data;
  }
}

function printDebug() {
  &#x2F;*DebugObj(&#x27;#debug&#x27;, {
    o1 : {
      object : notebook,
      readDom : true
    }
  });*&#x2F;
}
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
