var MVC={Controller:function(a){return a},ModelView:function(a,c,b){console.log("Create()");null===b||void 0===b?b={viewId:a,reflectModelChangeInView:!0}:$.extend(b,{viewId:a});b.reflectModelChangeInView&&$.each(c,function(b){MVC.AddGetSet(c,b,function(b){$(a).getSetHtml(c);$(":input[name="+b+"]").not(".excludeFromModel").trigger("change")})});$(a).getSetHtml(c);MVC.SetModelFromDomValues(a,c);$(a+" :input").not(".excludeFromModel").focus(function(){console.log("onFocus");var c=$(this).attr("name"),
e=MVC.GetDomVal(a)[c];console.log(c+" : "+e);if(void 0!==b.settings.onFocus&&null!==b.settings.onFocus)b.settings.onFocus(c,e)}).blur(function(){console.log("onBlur");var c=$(this).attr("name"),b=MVC.GetDomVal(a)[c];console.log(c+" : "+b)}).change(function(){console.log("onChange");var d=$(this).attr("name"),e=MVC.GetDomVal(a)[d];console.log(d+" : "+e);MVC.SetModelFromDomValues(a,c);if(void 0!==b.settings.onChange&&null!==b.settings.onChange)b.settings.onChange(d,e)}).select(function(){console.log("onSelect");
var a=$(this).attr("name"),c=$(this).val();console.log(a+" : "+c)}).submit(function(){alert("submit")});b={settings:b};$.extend(c,b);return c},Save:function(a){var c=a.settings.controller.Save;void 0!==c&&null!==c?c(a):alert("missing save func.")},Update:function(a){var c=a.settings.controller.Update;void 0!==c&&null!==c?c(a):alert("missing update func.")},Delete:function(a){var c=a.settings.controller.Delete;void 0!==c&&null!==c?c(a):alert("missing save func.")},Set:function(a,c,b){$(a).trigger("set"+
Common.FirstCharToUpper(c),[b]);console.log("Set)")},Get:function(a,c){console.log("Get()");var b={val:0};$(a).triggerHandler("get"+Common.FirstCharToUpper(c),[b]);return b.val},AddGetSet:function(a,c,b){console.log("AddGetSet");var d=Common.FirstCharToUpper(c);$(a).bind("get"+d,function(b,d){d.val=a[c]}).bind("set"+d,function(d,g){var f=a[c];a[c]=g;b(c,f,g)})},GetDomVal:function(a){console.log("GetDomVal()");return $(a).getSetHtml()},SetModelFromDomValues:function(a,c){console.log("SetModelFromDomValues()");
var b=MVC.GetDomVal(a);$.each(b,function(b,e){c[b]=e;MVC.SetDataboundDomVal(a,b,e)});return b},SetDataboundDomVal:function(a,c,b){console.log("SetDataboundDomVal()");$("[datasrc="+a+"][name="+c+"]").html(b).val(b)}},Common={FirstCharToUpper:function(a){return a.substring(0,1).toUpperCase()+a.substring(1,a.length)}};
(function(a){a.fn.extend({getSetHtml:function(a){return void 0!==a?this.setValues(a):this.getValues()},getInputElements:function(a){return a.find("input,button,select,textarea").filter(":not(.excludeFromModel)")},getDivElements:function(a){return a.find("p,span,div").filter(":not(.excludeFromModel)")},setValues:function(c){console.log("setValues called!");this.getDivElements(this).each(function(){var b=a(this).attr("datafld");void 0===b&&(b=a(this).attr("id"));void 0!==b&&(b=c[b],a(this).html(b))});
this.getInputElements(this).each(function(){var b=c[a(this).attr("name")],d;void 0!==b&&(d=a(this),d.is(":radio")?d.val()===b&&d.attr("checked",!0):(d.is(":checkbox")&&(b=a.isArray(b)?b:[b],-1<a.inArray(d.val(),b)&&d.attr("checked",!0)),d.val(b)))})},getValues:function(){var c={},b={};this.getInputElements(this).each(function(){var c=a(this),e=c.attr("type"),g=c.attr("name"),f=c.val();"submit"!==e&&g&&(c.hasClass("isNumber")&&(f=parseInt(f)),c.is(":checkbox")?(f=!1,c.attr("checked")&&(f=!0),b[g]=
f):c.is(":radio")?c.attr("checked")&&(b[g]=f):b[g]=f)});this.getDivElements(this).each(function(){var b=a(this).html();if(void 0!==b){var e=a(this).attr("datafld");void 0===e&&(e=a(this).attr("id"));void 0!==e&&(c[e]=b)}});return c=a.extend(c,b)}})})(jQuery);