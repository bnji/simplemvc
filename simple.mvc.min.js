var CMN={LOG:function(d){console.log(d)},JSTR:function(d){return CMN.JSTR(d,null,2)}},MVC={Controller:function(d){return d},ModelView:function(d,a,b){if(null===a||void 0===a)a={};var e=b.clone;e.template=d;if(void 0!==e){var d=e.id,f=d.substring(1,d.length),f=$($(e.template).clone(e.withDataAndEvents)).attr("id",f);$(f).find("[datasrc]").attr("datasrc",d);f.show();$(e.target).append(f)}if(null===b||void 0===b)b={};void 0===b.viewId&&$.extend(b,{viewId:d});void 0===b.reflectModelChangeInView&&$.extend(b,
{reflectModelChangeInView:!0});void 0===b.eventUsed&&$.extend(b,{eventUsed:""});a.Save=function(c){a.ExecuteController("Save",c)};a.Update=function(c){a.ExecuteController("Update",c)};a.Delete=function(c){a.ExecuteController("Delete",c)};a.Clear=function(c){a.Set(c,"")};a.ClearAll=function(){};a.AddGetSet=function(c,b){$(a).bind("get"+c,function(b,g){g.value=a[c]}).bind("set"+c,function(d,e){var f=a[c];f!==e&&(a[c]=e,b(c,f,e))})};a.RemoveGetSet=function(c){$(a).unbind("get"+c).unbind("set"+c)};a.Set=
function(c,b){$(a).triggerHandler("set"+c,[b]);a.SetDataboundDomVal(d,c,b)};a.Get=function(c){var b={value:void 0};$(a).triggerHandler("get"+c,[b]);return b.value};a.GetViewData=function(){return $(d).getSetHtml()};a.SetViewFromModel=function(){$(d).getSetHtml(a)};a.SetModelFromView=function(){var c=a.GetViewData();$.each(c,function(c,b){a[c]!==b&&(a[c]=b,a.SetDataboundDomVal(d,c,b))});return c};a.SetDataboundDomVal=function(a,b,e){$("div[datasrc|="+a+"][name|="+b+"],p[datasrc|="+a+"][name|="+b+"],span[datasrc|="+
a+"][name|="+b+"]").text(e);$("input[datasrc|="+a+"][name|="+b+"]").val(e)};a.RunEvent=function(a){var e=a.type;void 0===e&&(e=a);void 0!==a&&(0<$.trim(a.target.name).length?void 0!==b.settings[e]&&null!==b.settings[e]&&(b.settings.eventUsed=e,console.log(e),b.settings[e](a,a.target.name,a.target.value)):CMN.LOG("source element has no name attribute assigned (required!)"))};a.ExecuteController=function(b,e){var d=a.settings.controller[b];void 0!==d&&null!==d?d(a,e):CMN.LOG("Missing "+b+"() method!")};
a.toArray=function(){return $.makeArray(a)};a.SetViewFromModel();a.SetModelFromView();b.reflectModelChangeInView&&$.each(a,function(b){a.AddGetSet(b,function(b){a.SetViewFromModel();$(":input[name="+b+"]").not(".excludeFromModel").trigger("change")})});0<b.autoSaveInterval&&(b.eventUsed='"autoSave"',setInterval(function(){a.Save()},b.autoSaveInterval));$(d+" :input").not(".excludeFromModel").focus(function(b){a.RunEvent(b)}).blur(function(b){a.RunEvent(b)}).change(function(b){a.SetModelFromView();
a.RunEvent(b)}).select(function(b){a.RunEvent(b)}).submit(function(b){a.RunEvent(b)}).keyup(function(e){b.settings.keyup===void 0&&a.SetModelFromView();a.RunEvent(e)}).keypress(function(b){a.RunEvent(b)}).keydown(function(b){a.RunEvent(b)});b={settings:b};$.extend(a,b);return a}};
(function(d){d.fn.extend({getSetHtml:function(a){return void 0!==a?this.setValues(a):this.getValues()},getInputElements:function(a){return a.find("input,select,textarea").filter(":not(.excludeFromModel)")},getElementKey:function(a){var b=d(a).attr("datafld");void 0===b&&(b=d(a).attr("id"));return b},getDivElements:function(a){return a.find("p,span,div").filter(":not(.excludeFromModel)")},setValues:function(a){$this=this;$this.getDivElements(this).each(function(){var b=$this.getElementKey(this);void 0!==
b&&(b=a[b],d(this).text(b))});$this.getInputElements(this).each(function(){var b=a[d(this).attr("name")],e;void 0!==b&&(e=d(this),e.is(":radio")?e.val()===b&&e.attr("checked",!0):(e.is(":checkbox")&&(b=d.isArray(b)?b:[b],-1<d.inArray(e.val(),b)&&e.attr("checked",!0)),e.val(b)))})},getValues:function(){var a={},b={};$this=this;$this.getInputElements(this).each(function(){var a=d(this),f=a.attr("type"),c=a.attr("name"),g=a.val();"submit"!==f&&c&&(a.hasClass("isNumber")&&(g=parseInt(g)),a.is(":checkbox")?
(g=!1,a.attr("checked")&&(g=!0),b[c]=g):a.is(":radio")?a.attr("checked")&&(b[c]=g):b[c]=g)});$this.getDivElements(this).each(function(){var b=d(this),f=b.text();if(void 0!==f){var c=$this.getElementKey(this);void 0!==c&&(b.hasClass("isNumber")&&(f=parseInt(f)),a[c]=f)}});d.extend(a,b);return a}})})(jQuery);