var MVC={KeyCheck:function(t,e){return 13!==t.keyCode||"enter"!==e&&"return"!==e?27===t.keyCode&&"escape"===e?!0:!1:!0},List:function(t){if(null===t||void 0===t)t=[];else if(!$.isArray(t)&&"object"==typeof t){var e=[],n=0;$.each(t,function(t,r){"function"!=typeof r&&(e[n]=r,n++)}),t=e}return t.Size=function(){return t.length},t.Add=function(e){return t.push(e),t},t.Get=function(e){return t[e]},t.Find=function(e,n){var r;return $.each(t,function(t,i){return i[e]===n?(r=i,!1):void 0}),r},t.Remove=function(e){var n=$.inArray(e,t);return-1!==n?(t.splice(n,1),!0):!1},t.Contains=function(e){return-1!==$.inArray(e,t)},t.Clear=function(){t=[]},t},Controller:function(t){return t}};!function(t){t.fn.extend({ModelView:function(e,n,r){$this=t(this);var i="#"+$this.attr("id");e=e?t.extend({},!0,e):{},r?e=t.extend({},!0,e,r):r={},n||(n={});var a=n.datasrc,o=n.clone;if(void 0!==o){o.template=i,i=void 0===o.id?"#"+t.now():""+o.id,viewIdNoHash="#"===i.substring(0,1)?i.substring(1,i.length):i;var u=n.clone.withDataAndEvents;u=void 0!==u?u:!1,n.clone.withDataAndEvents=u;var d=t(t(o.template).clone(u)).attr("id",viewIdNoHash);a=void 0!==a?a:i,t(d).find('[datasrc=""]').attr("datasrc",a),o.append(d)}void 0===n.viewId&&t.extend(n,{viewId:i}),void 0===n.isMirror&&t.extend(n,{isMirror:!0}),void 0===n.eventUsed&&t.extend(n,{eventUsed:""}),void 0===n.preventDefault&&t.extend(n,{preventDefault:!0}),t(i).find("*").each(function(){t(this).hasClass("isEvent")&&t(this).click(function(r){var i=t(r.target).attr("name");e.Start(i,r),n.settings.preventDefault&&r.preventDefault()})}),e.Save=function(t){return e.Start("Save",t)},e.Update=function(t){return e.Start("Update",t)},e.Delete=function(t){return e.Start("Delete",t)},e.Clear=function(t){return e.Set(t,""),e[t]="",e},e.ClearAll=function(){return t.each(e.GetModelData(),function(t){e.Clear(t)}),e},e.AddGetSet=function(n){return t(e).bind("get"+n,function(t,r){r.value=e[n]}).bind("set"+n,function(t,r){var i=e[n];i!==r&&(e[n]=r,e.SetViewFromModel(),e.TriggerEvent(n,"change"))}),e},e.RemoveGetSet=function(n){return t(e).unbind("get"+n).unbind("set"+n),e},e.TriggerEvent=function(n,r){return t(i+' :input[name="'+n+'"]').not(".excludeFromModel").trigger(r),e},e.AddProperty=function(t,n){return e[t]=n,e.AddGetSet(t),e},e.RemoveProperty=function(t){return e.RemoveGetSet(t),delete e[t],e},e.Set=function(n,r){return e.settings.isMirror&&!e.Has(n)&&e.AddProperty(n,r),t(e).triggerHandler("set"+n,[r]),e.SetDataboundDomVal(a?a:i,n,r),e},e.Get=function(n){var r={value:void 0};return t(e).triggerHandler("get"+n,[r]),r.value},e.Has=function(t){return void 0!==e.Get(t)?!0:!1},e.GetDatasrcId=function(){return e.datasrc},e.GetModelData=function(n){var r={};return t.each(e,function(t,e){if("function"!==(typeof e).toString()){if(/jQuery\d*/.test(t))return!0;if(!n&&"settings"===t)return!0;r[t]=e}}),r},e.GetViewHtml=function(){return $this},e.GetViewData=function(){return t(i).getSetHtml()},e.SetViewData=function(){t(i).getSetHtml(e)},e.SetViewFromModel=function(){return e.SetViewData(),t.each(e.GetModelData(),function(t,n){e.SetDataboundDomVal(i,t,n)}),e},e.SetModelFromView=function(){var n=e.GetViewData();return t.each(n,function(t,n){var r=e[t];r!==n&&(e[t]=n),e.SetDataboundDomVal(i,t,n)}),e},e.SetDataboundDomVal=function(n,r,i){var a=navigator.appVersion;return-1!==a.indexOf("MSIE 7.")||-1!==a.indexOf("MSIE 8.")?t('div[datasrc|="'+n+'"][name|="'+r+'"],p[datasrc|="'+n+'"][name|="'+r+'"],span[datasrc|="'+n+'"][name|="'+r+'"]').text(i):t('*[datasrc|="'+n+'"][name|="'+r+'"]').text(i),t('input[datasrc|="'+n+'"][name|="'+r+'"]').val(i),e},e.RunEvent=function(r){var i=r.type;return void 0===i&&(i=r),void 0!==r?(t.trim(r.target.name).length>0?void 0!==n.settings[i]&&null!==n.settings[i]&&(n.settings.eventUsed=i,n.settings[i](r,r.target.name,r.target.value,e)):console.log("source element has no name attribute assigned (required!)"),e):void 0},e.RunCtr=function(t,n){e.Start(t,n)},e.Start=function(t,n){var r;return void 0!==e.settings.controller&&(r=e.settings.controller[t]),void 0===r&&(r=e[t]),void 0!==r&&null!==r?r(n,e):console.log("Missing "+t+"() method!"),e},e.toArray=function(){return t.makeArray(e)},e.GetViewId=function(){return e.settings.viewId},e.Find=function(n){return t(e.GetViewId()+" "+n)},e.AddEvents=function(){return t(i+" :input").focus(function(t){e.RunEvent(t)}).blur(function(t){e.RunEvent(t)}).change(function(t){e.SetModelFromView(),e.RunEvent(t)}).select(function(t){e.RunEvent(t)}).submit(function(t){e.RunEvent(t)}).keyup(function(t){void 0===n.settings.keyup&&e.SetModelFromView(),e.RunEvent(t)}).keypress(function(t){e.RunEvent(t)}).keydown(function(t){e.RunEvent(t)}),e},e.SetViewFromModel(),e.SetModelFromView(),n.isMirror&&t.each(e,function(t){e.AddGetSet(t)}),n.autoSaveInterval>0&&(n.eventUsed='"autoSave"',setInterval(function(){e.Save()},n.autoSaveInterval)),e.AddEvents(),n={settings:n},t.extend(e,n);var s=e.init;return void 0!==s&&null!==s&&setTimeout(function(){s(e)},1),e}})}(jQuery),function(t){t.fn.extend({getSetHtml:function(t){return void 0!==t?this.setValues(t):this.getValues()},getInputElements:function(t){return t.find("input,select,textarea").not(".excludeFromModel")},getElementKey:function(e){var n=t(e).attr("datafld");return void 0===n&&(n=t(e).attr("id")),void 0===n&&(n=t(e).attr("data-bind")),n},getBindableElements:function(t){return t.find("*[data-bind], *[datafld]").filter(":not(.excludeFromModel)")},setValues:function(e){var n=this;n.getBindableElements(this).each(function(){var r=n.getElementKey(this);if(void 0!==r){var i=e[r];t(this).html(i)}}),n.getInputElements(this).each(function(){var n,r=e[t(this).attr("name")];void 0!==r&&(n=t(this),n.is(":radio")?n.val()===r&&n.attr("checked",!0):n.is(":checkbox")?(r?n.attr("checked",!0):(r=t.isArray(r)?r:[r],t.inArray(n.val(),r)>-1&&n.attr("checked",!0)),n.val(r)):n.val(r))})},getValues:function(){var e={},n={},r=this;return r.getInputElements(this).each(function(){var e=t(this),r=e.attr("type"),i=e.attr("name"),a=e.val();"submit"!==r&&i&&(e.hasClass("isNumber")&&(a=parseInt(a,null)),e.is(":checkbox")?(a=!1,e.attr("checked")&&(a=!0),n[i]=a):e.is(":radio")?e.attr("checked")&&(n[i]=a):n[i]=a)}),r.getBindableElements(this).each(function(){var n=t(this),i=n.text();if(void 0!==i){var a=r.getElementKey(this);if(void 0===a)return;n.hasClass("isNumber")&&(i=parseInt(i,null)),e[a]=i}}),t.extend(e,n),e}})}(jQuery);