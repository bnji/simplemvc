var CMN={LOG:function(d){console.log(d)},JSTR:function(d){return CMN.JSTR(d,null,2)}},MVC={Controller:function(d){return d},ModelView:function(d,a,c){if(null===a||void 0===a)a={};if(null===c||void 0===c)c={};void 0===c.viewId&&$.extend(c,{viewId:d});void 0===c.reflectModelChangeInView&&$.extend(c,{reflectModelChangeInView:!0});a.Save=function(b){a.ExecuteController("Save",b)};a.Update=function(b){a.ExecuteController("Update",b)};a.Delete=function(b){a.ExecuteController("Delete",b)};a.AddGetSet=function(b,
c){$(a).bind("get"+b,function(c,f){f.value=a[b]}).bind("set"+b,function(d,e){var h=a[b];h!==e&&(a[b]=e,c(b,h,e))})};a.RemoveGetSet=function(b){$(a).unbind("get"+b).unbind("set"+b)};a.Set=function(b,c){$(a).triggerHandler("set"+b,[c])};a.Get=function(b){var c={value:void 0};$(a).triggerHandler("get"+b,[c]);return c.value};a.SetViewFromModel=function(){$(d).getSetHtml(a)};a.GetViewData=function(){return $(d).getSetHtml()};a.SetModelFromView=function(b){var c=a.GetViewData();$.each(c,function(c,f){a[c]!==
f&&(a[c]=f,(void 0===b||!0===b)&&a.SetDataboundDomVal(d,c,f))});return c};a.SetDataboundDomVal=function(b,a,c){$("div[datasrc|="+b+"][name|="+a+"],p[datasrc|="+b+"][name|="+a+"],span[datasrc|="+b+"][name|="+a+"]").text(c);$("input[datasrc|="+b+"][name|="+a+"]").val(c)};a.RunEvent=function(b){var a=b.type;void 0===a&&(a=b);if(void 0!==b)if(0<$.trim(b.target.name).length){if(void 0!==c.settings[a]&&null!==c.settings[a])c.settings[a](b,b.target.name,b.target.value)}else CMN.LOG("source element has no name attribute assigned (required!)")};
a.ExecuteController=function(b,c){var d=a.settings.controller[b];void 0!==d&&null!==d?d(a,c):CMN.LOG("Missing "+b+"() method!")};a.toArray=function(){return $.makeArray(a)};a.SetViewFromModel();a.SetModelFromView();c.reflectModelChangeInView&&$.each(a,function(b){a.AddGetSet(b,function(b){a.SetViewFromModel();$(":input[name="+b+"]").not(".excludeFromModel").trigger("change")})});0<c.autoSaveInterval&&setInterval(function(){a.Save()},c.autoSaveInterval);$(d+" :input").not(".excludeFromModel").focus(function(b){a.RunEvent(b)}).blur(function(b){a.RunEvent(b)}).change(function(b){a.SetModelFromView();
a.RunEvent(b)}).select(function(b){a.RunEvent(b)}).submit(function(b){a.RunEvent(b)}).keyup(function(b){void 0===c.settings.keyup&&a.SetModelFromView();a.RunEvent(b)}).keypress(function(b){a.RunEvent(b)}).keydown(function(b){a.RunEvent(b)});c={settings:c};$.extend(a,c);return a}};
(function(d){d.fn.extend({getSetHtml:function(a){return void 0!==a?this.setValues(a):this.getValues()},getInputElements:function(a){return a.find("input,select,textarea").filter(":not(.excludeFromModel)")},getElementKey:function(a){var c=d(a).attr("datafld");void 0===c&&(c=d(a).attr("id"));return c},getDivElements:function(a){return a.find("p,span,div").filter(":not(.excludeFromModel)")},setValues:function(a){CMN.LOG("setValues called!");$this=this;$this.getDivElements(this).each(function(){var c=
$this.getElementKey(this);void 0!==c&&(c=a[c],CMN.LOG(c),d(this).text(c))});$this.getInputElements(this).each(function(){var c=a[d(this).attr("name")],b;void 0!==c&&(b=d(this),b.is(":radio")?b.val()===c&&b.attr("checked",!0):(b.is(":checkbox")&&(c=d.isArray(c)?c:[c],-1<d.inArray(b.val(),c)&&b.attr("checked",!0)),b.val(c)))})},getValues:function(){var a={},c={};$this=this;$this.getInputElements(this).each(function(){var a=d(this),f=a.attr("type"),g=a.attr("name"),e=a.val();"submit"!==f&&g&&(a.hasClass("isNumber")&&
(e=parseInt(e)),a.is(":checkbox")?(e=!1,a.attr("checked")&&(e=!0),c[g]=e):a.is(":radio")?a.attr("checked")&&(c[g]=e):c[g]=e)});$this.getDivElements(this).each(function(){var b=d(this),c=b.text();if(void 0!==c){var g=$this.getElementKey(this);void 0!==g&&(b.hasClass("isNumber")&&(c=parseInt(c)),a[g]=c)}});return a=d.extend(a,c)}})})(jQuery);