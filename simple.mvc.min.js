var MVC={KeyCheck:function(c,a){return 13===c.keyCode&&("enter"===a||"return"===a)||27===c.keyCode&&"escape"===a?!0:!1},List:function(c){if(null===c||void 0===c)c=[];else if(!$.isArray(c)&&"object"===typeof c){var a=[],e=0;$.each(c,function(c,d){"function"!==typeof d&&(a[e]=d,e++)});c=a}c.Size=function(){return c.length};c.Add=function(a){c.push(a);return c};c.Remove=function(a){var d=$.inArray(a,c);return-1!==d?(c.splice(d,1),console.log("removed "+a+" from array"),!0):!1};return c},Controller:function(c){return c}};
(function(c){c.fn.extend({ModelView:function(a,e,f){$this=c(this);var d="#"+$this.attr("id"),a=a?c.extend({},!0,a):{};f?a=c.extend({},!0,a,f):f={};e||(e={});var i=e.datasrc,f=e.clone;if(void 0!==f){f.template=d;d=""+f.id;viewIdNoHash="#"===d.substring(0,1)?d.substring(1,d.length):d;var g=e.clone.withDataAndEvents,g=void 0!==g?g:!1;e.clone.withDataAndEvents=g;g=c(c(f.template).clone(g)).attr("id",viewIdNoHash);i=void 0!==i?i:d;c(g).find('[datasrc=""]').attr("datasrc",i);f.append(g)}void 0===e.viewId&&
c.extend(e,{viewId:d});void 0===e.isMirror&&c.extend(e,{isMirror:!0});void 0===e.eventUsed&&c.extend(e,{eventUsed:""});void 0===e.preventDefault&&c.extend(e,{preventDefault:!0});c(d+" button,"+d+" a,"+d+" submit,"+d+" i").each(function(){c(this).click(function(b){a.RunCtr(b.target.name,b);e.settings.preventDefault&&b.preventDefault()})});a.Save=function(b){return a.RunCtr("Save",b)};a.Update=function(b){return a.RunCtr("Update",b)};a.Delete=function(b){return a.RunCtr("Delete",b)};a.Clear=function(b){a.Set(b,
"");a[b]="";return a};a.ClearAll=function(){c.each(a.GetModelData(),function(b){a.Clear(b)});return a};a.AddGetSet=function(b){c(a).bind("get"+b,function(c,d){d.value=a[b]}).bind("set"+b,function(c,d){a[b]!==d&&(a[b]=d,a.SetViewFromModel(),a.TriggerEvent(b,"change"))});return a};a.RemoveGetSet=function(b){c(a).unbind("get"+b).unbind("set"+b);return a};a.TriggerEvent=function(b,e){c(d+' :input[name="'+b+'"]').not(".excludeFromModel").trigger(e);return a};a.AddProperty=function(b,c){a[b]=c;a.AddGetSet(b);
console.log("Added property "+b+" to the Model.");return a};a.RemoveProperty=function(b){a.RemoveGetSet(b);delete a[b];console.log("Removed property "+b+" from the Model.");return a};a.Set=function(b,d){c(a).triggerHandler("set"+b,[d]);a.SetDataboundDomVal(i,b,d);return a};a.Get=function(b){var d={value:void 0};c(a).triggerHandler("get"+b,[d]);return d.value};a.Has=function(b){return void 0!==a.Get(b)?!0:!1};a.GetDatasrcId=function(){return a.datasrc};a.GetModelData=function(b){var d={};c.each(a,
function(a,c){if("function"!==(typeof c).toString()){if(/jQuery\d*/.test(a)||!b&&"settings"===a)return!0;d[a]=c}});return d};a.GetViewHtml=function(){return $this};a.GetViewData=function(){return c(d).getSetHtml()};a.SetViewData=function(){c(d).getSetHtml(a)};a.SetViewFromModel=function(){a.SetViewData();c.each(a.GetModelData(),function(b,c){a.SetDataboundDomVal(d,b,c)});return a};a.SetModelFromView=function(){var b=a.GetViewData();c.each(b,function(b,c){a[b]!==c&&(a[b]=c);a.SetDataboundDomVal(d,
b,c)});return a};a.SetDataboundDomVal=function(b,d,e){c("div[datasrc|="+b+"][name|="+d+"],p[datasrc|="+b+"][name|="+d+"],span[datasrc|="+b+"][name|="+d+"]").text(e);c("input[datasrc|="+b+"][name|="+d+"]").val(e);return a};a.RunEvent=function(b){var d=b.type;void 0===d&&(d=b);if(void 0!==b)return 0<c.trim(b.target.name).length?void 0!==e.settings[d]&&null!==e.settings[d]&&(e.settings.eventUsed=d,e.settings[d](b,b.target.name,b.target.value)):console.log("source element has no name attribute assigned (required!)"),
a};a.RunCtr=function(b,c){var d=a.settings.controller[b];void 0!==d&&null!==d?d(c):console.log("Missing "+b+"() method!");return a};a.toArray=function(){return c.makeArray(a)};a.GetViewId=function(){return a.settings.viewId};a.Find=function(b){return c(a.GetViewId()+" "+b)};a.AddEvents=function(){c(d+" :input").not(".excludeFromModel").focus(function(b){a.RunEvent(b)}).blur(function(b){a.RunEvent(b)}).change(function(b){a.SetModelFromView();a.RunEvent(b)}).select(function(b){a.RunEvent(b)}).submit(function(b){a.RunEvent(b)}).keyup(function(b){void 0===
e.settings.keyup&&a.SetModelFromView();a.RunEvent(b)}).keypress(function(b){a.RunEvent(b)}).keydown(function(b){a.RunEvent(b)});return a};a.SetViewFromModel();a.SetModelFromView();e.isMirror&&c.each(a,function(b){a.AddGetSet(b)});0<e.autoSaveInterval&&(e.eventUsed='"autoSave"',setInterval(function(){a.Save()},e.autoSaveInterval));a.AddEvents();e={settings:e};c.extend(a,e);var h=a.init;void 0!==h&&null!==h&&setTimeout(function(){h()},1);return a}})})(jQuery);
(function(c){c.fn.extend({getSetHtml:function(a){return void 0!==a?this.setValues(a):this.getValues()},getInputElements:function(a){return a.find("input,select,textarea").filter(":not(.excludeFromModel)")},getElementKey:function(a){var e=c(a).attr("datafld");void 0===e&&(e=c(a).attr("id"));return e},getDivElements:function(a){return a.find("p,span,div").filter(":not(.excludeFromModel)")},setValues:function(a){var e=this;e.getDivElements(this).each(function(){var f=e.getElementKey(this);void 0!==f&&
(f=a[f],c(this).html(f))});e.getInputElements(this).each(function(){var e=a[c(this).attr("name")],d;void 0!==e&&(d=c(this),d.is(":radio")?d.val()===e&&d.attr("checked",!0):(d.is(":checkbox")&&(e?d.attr("checked",!0):(e=c.isArray(e)?e:[e],-1<c.inArray(d.val(),e)&&d.attr("checked",!0))),d.val(e)))})},getValues:function(){var a={},e={},f=this;f.getInputElements(this).each(function(){var a=c(this),f=a.attr("type"),g=a.attr("name"),h=a.val();"submit"!==f&&g&&(a.hasClass("isNumber")&&(h=parseInt(h,null)),
a.is(":checkbox")?(h=!1,a.attr("checked")&&(h=!0),e[g]=h):a.is(":radio")?a.attr("checked")&&(e[g]=h):e[g]=h)});f.getDivElements(this).each(function(){var d=c(this),e=d.text();if(void 0!==e){var g=f.getElementKey(this);void 0!==g&&(d.hasClass("isNumber")&&(e=parseInt(e,null)),a[g]=e)}});c.extend(a,e);return a}})})(jQuery);