var MVC={KeyCheck:function(d,a){if(13===d.keyCode&&("enter"===a||"return"===a)||27===d.keyCode&&"escape"===a)return!0},List:function(d){if(void 0===d||null===d)d=[];d.Add=function(a){d.push(a);return d};d.Remove=function(a){a=$.inArray(a,d);return-1!==a?(d.splice(a,1),!0):!1};return d},Controller:function(d){return d},ModelView:function(d,a,c,e){a=a?$.extend({},!0,a):{};e?a=$.extend({},!0,a,e):e={};c||(c={});e=c.clone;if(void 0!==e){e.template=d;var d=e.id,f=d.substring(1,d.length),f=$($(e.template).clone(e.withDataAndEvents)).attr("id",
f);$(f).find('[datasrc=""]').attr("datasrc",d);e.append(f)}void 0===c.viewId&&$.extend(c,{viewId:d});void 0===c.reflectModelChangeInView&&$.extend(c,{reflectModelChangeInView:!0});void 0===c.eventUsed&&$.extend(c,{eventUsed:""});void 0===c.preventDefault&&$.extend(c,{preventDefault:!0});$(d+" button,"+d+" a,"+d+" submit,"+d+" i").each(function(){$(this).click(function(b){a.RunCtr(b.target.name,b);c.settings.preventDefault&&b.preventDefault()})});a.Save=function(b){a.RunCtr("Save",b);return a};a.Update=
function(b){a.RunCtr("Update",b);return a};a.Delete=function(b){a.RunCtr("Delete",b);return a};a.Clear=function(b){a.Set(b,"");return a};a.ClearAll=function(){$.each(a.GetModelData(),function(b){a.Clear(b)});return a};a.AddGetSet=function(b){$(a).bind("get"+b,function(d,c){c.value=a[b]}).bind("set"+b,function(d,c){a[b]!==c&&(a[b]=c,a.SetViewFromModel(),a.TriggerEvent(b,"change"))});return a};a.RemoveGetSet=function(b){$(a).unbind("get"+b).unbind("set"+b);return a};a.TriggerEvent=function(b,c){$(d+
' :input[name="'+b+'"]').not(".excludeFromModel").trigger(c);return a};a.AddProperty=function(b){a.AddEvents().AddGetSet(b).TriggerEvent(b,"keyup");console.log("Added property "+b+" to the Model.");return a};a.RemoveProperty=function(b){a.RemoveGetSet(b);delete a[b];$(d+' :input[name="'+b+'"]').not(".excludeFromModel").remove();console.log("Removed property "+b+" from the Model.");return a};a.Set=function(b,c){$(a).triggerHandler("set"+b,[c]);a.SetDataboundDomVal(d,b,c);return a};a.Get=function(b){var d=
{value:void 0};$(a).triggerHandler("get"+b,[d]);return d.value};a.Has=function(b){return void 0!==a.Get(b)?!0:!1};a.GetModelData=function(b){var d={};$.each(a,function(a,c){if("function"!==(typeof c).toString()){if(/jQuery\d*/.test(a)||!b&&"settings"===a)return!0;d[a]=c}});return d};a.GetViewData=function(){return $(d).getSetHtml()};a.SetViewFromModel=function(){$(d).getSetHtml(a);return a};a.SetModelFromView=function(){var b=a.GetViewData();$.each(b,function(b,c){a[b]!==c&&(a[b]=c,a.SetDataboundDomVal(d,
b,c))});return a};a.SetDataboundDomVal=function(b,c,d){$("div[datasrc|="+b+"][name|="+c+"],p[datasrc|="+b+"][name|="+c+"],span[datasrc|="+b+"][name|="+c+"]").text(d);$("input[datasrc|="+b+"][name|="+c+"]").val(d);return a};a.RunEvent=function(b){var d=b.type;void 0===d&&(d=b);if(void 0!==b)return 0<$.trim(b.target.name).length?void 0!==c.settings[d]&&null!==c.settings[d]&&(c.settings.eventUsed=d,c.settings[d](b,b.target.name,b.target.value)):console.log("source element has no name attribute assigned (required!)"),
a};a.RunCtr=function(b,d){var c=a.settings.controller[b];void 0!==c&&null!==c?c(d):console.log("Missing "+b+"() method!");return a};a.toArray=function(){return $.makeArray(a)};a.GetViewId=function(){return a.settings.viewId};a.FindElement=function(b){return $(a.GetViewId()+" "+b)};a.AddEvents=function(){$(d+" :input").not(".excludeFromModel").focus(function(b){a.RunEvent(b)}).blur(function(b){a.RunEvent(b)}).change(function(b){a.SetModelFromView();a.RunEvent(b)}).select(function(b){a.RunEvent(b)}).submit(function(b){a.RunEvent(b)}).keyup(function(b){void 0===
c.settings.keyup&&a.SetModelFromView();a.RunEvent(b)}).keypress(function(b){a.RunEvent(b)}).keydown(function(b){a.RunEvent(b)});return a};a.SetViewFromModel();a.SetModelFromView();c.reflectModelChangeInView&&$.each(a,function(b){a.AddGetSet(b)});0<c.autoSaveInterval&&(c.eventUsed='"autoSave"',setInterval(function(){a.Save()},c.autoSaveInterval));a.AddEvents();c={settings:c};$.extend(a,c);var g=a.init;void 0!==g&&null!==g&&setTimeout(function(){g()},1);return a}};
(function(d){d.fn.extend({getSetHtml:function(a){return void 0!==a?this.setValues(a):this.getValues()},getInputElements:function(a){return a.find("input,select,textarea").filter(":not(.excludeFromModel)")},getElementKey:function(a){var c=d(a).attr("datafld");void 0===c&&(c=d(a).attr("id"));return c},getDivElements:function(a){return a.find("p,span,div").filter(":not(.excludeFromModel)")},setValues:function(a){var c=this;c.getDivElements(this).each(function(){var e=c.getElementKey(this);void 0!==e&&
(e=a[e],d(this).html(e))});c.getInputElements(this).each(function(){var c=a[d(this).attr("name")],f;void 0!==c&&(f=d(this),f.is(":radio")?f.val()===c&&f.attr("checked",!0):(f.is(":checkbox")&&(c?f.attr("checked",!0):(c=d.isArray(c)?c:[c],-1<d.inArray(f.val(),c)&&f.attr("checked",!0))),f.val(c)))})},getValues:function(){var a={},c={},e=this;e.getInputElements(this).each(function(){var a=d(this),e=a.attr("type"),b=a.attr("name"),h=a.val();"submit"!==e&&b&&(a.hasClass("isNumber")&&(h=parseInt(h)),a.is(":checkbox")?
(h=!1,a.attr("checked")&&(h=!0),c[b]=h):a.is(":radio")?a.attr("checked")&&(c[b]=h):c[b]=h)});e.getDivElements(this).each(function(){var c=d(this),g=c.text();if(void 0!==g){var b=e.getElementKey(this);void 0!==b&&(c.hasClass("isNumber")&&(g=parseInt(g)),a[b]=g)}});d.extend(a,c);return a}})})(jQuery);