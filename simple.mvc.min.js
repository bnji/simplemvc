var CMN={LOG:function(c){console.log(c)},JSTR:function(c){return CMN.JSTR(c,null,2)}},MVC={Controller:function(c){return c},ModelView:function(c,a,b){if(null===a||void 0===a)a={};if(null===b||void 0===b)b={};var e=b.clone;if(void 0!==e){e.template=c;var c=e.id,f=c.substring(1,c.length),f=$($(e.template).clone(e.withDataAndEvents)).attr("id",f);$(f).find(c+' div[datasrc=""],p[datasrc=""],span[datasrc=""]').attr("datasrc",c);e.append(f)}void 0===b.viewId&&$.extend(b,{viewId:c});void 0===b.reflectModelChangeInView&&
$.extend(b,{reflectModelChangeInView:!0});void 0===b.eventUsed&&$.extend(b,{eventUsed:""});$(c).find("button,a,submit,i").each(function(){$(this).click(function(d){a.ExecuteController(d.target.name)})});a.Save=function(d){a.ExecuteController("Save",d)};a.Update=function(d){a.ExecuteController("Update",d)};a.Delete=function(d){a.ExecuteController("Delete",d)};a.Clear=function(d){a.Set(d,"")};a.ClearAll=function(){};a.AddGetSet=function(d,b){$(a).bind("get"+d,function(b,g){g.value=a[d]}).bind("set"+
d,function(c,e){var f=a[d];f!==e&&(a[d]=e,b(d,f,e))})};a.RemoveGetSet=function(d){$(a).unbind("get"+d).unbind("set"+d)};a.Set=function(d,b){$(a).triggerHandler("set"+d,[b]);a.SetDataboundDomVal(c,d,b)};a.Get=function(d){var b={value:void 0};$(a).triggerHandler("get"+d,[b]);return b.value};a.GetViewData=function(){return $(c).getSetHtml()};a.SetViewFromModel=function(){$(c).getSetHtml(a)};a.SetModelFromView=function(){var d=a.GetViewData();$.each(d,function(d,b){a[d]!==b&&(a[d]=b,a.SetDataboundDomVal(c,
d,b))});return d};a.SetDataboundDomVal=function(a,b,c){$("div[datasrc|="+a+"][name|="+b+"],p[datasrc|="+a+"][name|="+b+"],span[datasrc|="+a+"][name|="+b+"]").text(c);$("input[datasrc|="+a+"][name|="+b+"]").val(c)};a.RunEvent=function(a){var c=a.type;void 0===c&&(c=a);void 0!==a&&(0<$.trim(a.target.name).length?void 0!==b.settings[c]&&null!==b.settings[c]&&(b.settings.eventUsed=c,console.log(c),b.settings[c](a,a.target.name,a.target.value)):CMN.LOG("source element has no name attribute assigned (required!)"))};
a.ExecuteController=function(b,c){var e=a.settings.controller[b];void 0!==e&&null!==e?e(a,c):CMN.LOG("Missing "+b+"() method!")};a.toArray=function(){return $.makeArray(a)};a.SetViewFromModel();a.SetModelFromView();b.reflectModelChangeInView&&$.each(a,function(b){a.AddGetSet(b,function(b){a.SetViewFromModel();$(":input[name="+b+"]").not(".excludeFromModel").trigger("change")})});0<b.autoSaveInterval&&(b.eventUsed='"autoSave"',setInterval(function(){a.Save()},b.autoSaveInterval));$(c+" :input").not(".excludeFromModel").focus(function(b){a.RunEvent(b)}).blur(function(b){a.RunEvent(b)}).change(function(b){a.SetModelFromView();
a.RunEvent(b)}).select(function(b){a.RunEvent(b)}).submit(function(b){a.RunEvent(b)}).keyup(function(c){b.settings.keyup===void 0&&a.SetModelFromView();a.RunEvent(c)}).keypress(function(b){a.RunEvent(b)}).keydown(function(b){a.RunEvent(b)});b={settings:b};$.extend(a,b);return a}};
(function(c){c.fn.extend({getSetHtml:function(a){return void 0!==a?this.setValues(a):this.getValues()},getInputElements:function(a){return a.find("input,select,textarea").filter(":not(.excludeFromModel)")},getElementKey:function(a){var b=c(a).attr("datafld");void 0===b&&(b=c(a).attr("id"));return b},getDivElements:function(a){return a.find("p,span,div").filter(":not(.excludeFromModel)")},setValues:function(a){$this=this;$this.getDivElements(this).each(function(){var b=$this.getElementKey(this);void 0!==
b&&(b=a[b],c(this).text(b))});$this.getInputElements(this).each(function(){var b=a[c(this).attr("name")],e;void 0!==b&&(e=c(this),e.is(":radio")?e.val()===b&&e.attr("checked",!0):(e.is(":checkbox")&&(b=c.isArray(b)?b:[b],-1<c.inArray(e.val(),b)&&e.attr("checked",!0)),e.val(b)))})},getValues:function(){var a={},b={};$this=this;$this.getInputElements(this).each(function(){var a=c(this),f=a.attr("type"),d=a.attr("name"),g=a.val();"submit"!==f&&d&&(a.hasClass("isNumber")&&(g=parseInt(g)),a.is(":checkbox")?
(g=!1,a.attr("checked")&&(g=!0),b[d]=g):a.is(":radio")?a.attr("checked")&&(b[d]=g):b[d]=g)});$this.getDivElements(this).each(function(){var b=c(this),f=b.text();if(void 0!==f){var d=$this.getElementKey(this);void 0!==d&&(b.hasClass("isNumber")&&(f=parseInt(f)),a[d]=f)}});c.extend(a,b);return a}})})(jQuery);