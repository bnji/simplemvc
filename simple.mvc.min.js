var MVC={KeyCheck:function(c,a){return 13===c.keyCode&&("enter"===a||"return"===a)||27===c.keyCode&&"escape"===a?!0:!1},List:function(c){!$.isArray(c)&&"object"===typeof c&&(c=$.makeArray(c));if(void 0===c||null===c)c=[];c.Size=function(){return c.length};c.Add=function(a){c.push(a);return c};c.Remove=function(a){a=$.inArray(a,c);return-1!==a?(c.splice(a,1),!0):!1};return c},Controller:function(c){return c},ModelView:function(c,a,d,e){a=a?$.extend({},!0,a):{};e?a=$.extend({},!0,a,e):e={};d||(d={});
var f=d.datasrc,e=d.clone;if(void 0!==e){e.template=c;var c=e.id,i=c.substring(1,c.length),h=e.withDataAndEvents,i=$($(e.template).clone(void 0!==h?h:!1)).attr("id",i),f=void 0!==f?f:c;$(i).find('[datasrc=""]').attr("datasrc",f);e.append(i)}void 0===d.viewId&&$.extend(d,{viewId:c});void 0===d.isMirror&&$.extend(d,{isMirror:!0});void 0===d.eventUsed&&$.extend(d,{eventUsed:""});void 0===d.preventDefault&&$.extend(d,{preventDefault:!0});$(c+" button,"+c+" a,"+c+" submit,"+c+" i").each(function(){$(this).click(function(b){a.RunCtr(b.target.name,
b);d.settings.preventDefault&&b.preventDefault()})});a.Save=function(b){a.RunCtr("Save",b);return a};a.Update=function(b){a.RunCtr("Update",b);return a};a.Delete=function(b){a.RunCtr("Delete",b);return a};a.Clear=function(b){a[b]="";a.Set(b,"");return a};a.ClearAll=function(){$.each(a.GetModelData(),function(b){a.Clear(b)});return a};a.AddGetSet=function(b){$(a).bind("get"+b,function(c,d){d.value=a[b]}).bind("set"+b,function(c,d){a[b]!==d&&(a[b]=d,a.SetViewFromModel(),a.TriggerEvent(b,"change"))});
return a};a.RemoveGetSet=function(b){$(a).unbind("get"+b).unbind("set"+b);return a};a.TriggerEvent=function(b,d){$(c+' :input[name="'+b+'"]').not(".excludeFromModel").trigger(d);return a};a.AddProperty=function(b){a.AddEvents().AddGetSet(b).TriggerEvent(b,"keyup");console.log("Added property "+b+" to the Model.");return a};a.RemoveProperty=function(b){a.RemoveGetSet(b);delete a[b];$(c+' :input[name="'+b+'"]').not(".excludeFromModel").remove();console.log("Removed property "+b+" from the Model.");
return a};a.Set=function(b,c){$(a).triggerHandler("set"+b,[c]);a.SetDataboundDomVal(f,b,c);return a};a.Get=function(b){var c={value:void 0};$(a).triggerHandler("get"+b,[c]);return c.value};a.Has=function(b){return void 0!==a.Get(b)?!0:!1};a.GetModelData=function(b){var c={};$.each(a,function(a,d){if("function"!==(typeof d).toString()){if(/jQuery\d*/.test(a)||!b&&"settings"===a)return!0;c[a]=d}});return c};a.GetDatasrcId=function(){return a.datasrc};a.GetViewData=function(){return $(c).getSetHtml()};
a.SetViewFromModel=function(){$(c).getSetHtml(a);return a};a.SetModelFromView=function(){var b=a.GetViewData();$.each(b,function(b,d){a[b]!==d&&(a[b]=d);a.SetDataboundDomVal(c,b,d)});return a};a.SetDataboundDomVal=function(b,c,d){$("div[datasrc|="+b+"][name|="+c+"],p[datasrc|="+b+"][name|="+c+"],span[datasrc|="+b+"][name|="+c+"]").text(d);$("input[datasrc|="+b+"][name|="+c+"]").val(d);return a};a.RunEvent=function(b){var c=b.type;void 0===c&&(c=b);if(void 0!==b)return 0<$.trim(b.target.name).length?
void 0!==d.settings[c]&&null!==d.settings[c]&&(d.settings.eventUsed=c,d.settings[c](b,b.target.name,b.target.value)):console.log("source element has no name attribute assigned (required!)"),a};a.RunCtr=function(b,c){var d=a.settings.controller[b];void 0!==d&&null!==d?d(c):console.log("Missing "+b+"() method!");return a};a.toArray=function(){return $.makeArray(a)};a.GetViewId=function(){return a.settings.viewId};a.Find=function(b){return $(a.GetViewId()+" "+b)};a.AddEvents=function(){$(c+" :input").not(".excludeFromModel").focus(function(b){a.RunEvent(b)}).blur(function(b){a.RunEvent(b)}).change(function(b){a.SetModelFromView();
a.RunEvent(b)}).select(function(b){a.RunEvent(b)}).submit(function(b){a.RunEvent(b)}).keyup(function(b){void 0===d.settings.keyup&&a.SetModelFromView();a.RunEvent(b)}).keypress(function(b){a.RunEvent(b)}).keydown(function(b){a.RunEvent(b)});return a};a.SetViewFromModel();a.SetModelFromView();d.isMirror&&$.each(a,function(b){a.AddGetSet(b)});0<d.autoSaveInterval&&(d.eventUsed='"autoSave"',setInterval(function(){a.Save()},d.autoSaveInterval));a.AddEvents();d={settings:d};$.extend(a,d);var g=a.init;
void 0!==g&&null!==g&&setTimeout(function(){g()},1);return a}};
(function(c){c.fn.extend({getSetHtml:function(a){return void 0!==a?this.setValues(a):this.getValues()},getInputElements:function(a){return a.find("input,select,textarea").filter(":not(.excludeFromModel)")},getElementKey:function(a){var d=c(a).attr("datafld");void 0===d&&(d=c(a).attr("id"));return d},getDivElements:function(a){return a.find("p,span,div").filter(":not(.excludeFromModel)")},setValues:function(a){var d=this;d.getDivElements(this).each(function(){var e=d.getElementKey(this);void 0!==e&&
(e=a[e],c(this).html(e))});d.getInputElements(this).each(function(){var d=a[c(this).attr("name")],f;void 0!==d&&(f=c(this),f.is(":radio")?f.val()===d&&f.attr("checked",!0):(f.is(":checkbox")&&(d?f.attr("checked",!0):(d=c.isArray(d)?d:[d],-1<c.inArray(f.val(),d)&&f.attr("checked",!0))),f.val(d)))})},getValues:function(){var a={},d={},e=this;e.getInputElements(this).each(function(){var a=c(this),e=a.attr("type"),h=a.attr("name"),g=a.val();"submit"!==e&&h&&(a.hasClass("isNumber")&&(g=parseInt(g,null)),
a.is(":checkbox")?(g=!1,a.attr("checked")&&(g=!0),d[h]=g):a.is(":radio")?a.attr("checked")&&(d[h]=g):d[h]=g)});e.getDivElements(this).each(function(){var d=c(this),i=d.text();if(void 0!==i){var h=e.getElementKey(this);void 0!==h&&(d.hasClass("isNumber")&&(i=parseInt(i,null)),a[h]=i)}});c.extend(a,d);return a}})})(jQuery);